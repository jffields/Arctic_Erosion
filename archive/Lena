/**** Start of imports. If edited, may not auto-convert in the playground. ****/
var Lena_Watershed = /* color: #d63000 */ee.Geometry.Polygon(
        [[[105.01965531519193, 66.43936649180024],
          [103.81115922144193, 65.80794663900008],
          [107.06311234644193, 65.29874011962221],
          [106.20617875269193, 64.68571258377823],
          [106.73352250269193, 64.42136868649192],
          [108.95276078394193, 64.63869614907578],
          [108.62317094019193, 64.2691611619277],
          [108.88684281519193, 63.81715916414574],
          [108.68908890894193, 63.4561473540075],
          [109.28235062769193, 62.67993386320871],
          [109.08459672144193, 62.15086980848772],
          [108.73303422144193, 61.29740855550381],
          [108.73303422144193, 60.452603631821994],
          [109.19446000269193, 59.64081122153063],
          [108.82092484644193, 59.305991826240145],
          [108.20569047144193, 58.488803422729454],
          [105.74475297144193, 58.200519521369124],
          [104.42639359644193, 57.792956969565864],
          [104.16272172144193, 56.7234881553625],
          [104.44836625269193, 56.06681233583704],
          [104.99768265894193, 55.67230794544081],
          [103.85510453394193, 54.54115155666746],
          [104.09680375269193, 53.43014446644061],
          [105.30529984644193, 52.836942327627504],
          [106.57971390894193, 53.180680166823265],
          [108.05188187769193, 54.144086543296254],
          [108.53528031519193, 55.09816242607183],
          [108.60119828394193, 55.956262863207336],
          [109.28235062769193, 56.29915703704706],
          [110.35901078394193, 56.311346767124455],
          [111.39172562769193, 56.408724660610766],
          [112.79797562769193, 56.57853812963533],
          [113.45715531519193, 56.53009755435374],
          [112.64416703394193, 55.931653334075115],
          [112.16076859644193, 55.38627713157509],
          [111.80920609644193, 54.85857726567824],
          [111.19397172144193, 54.02809032370706],
          [110.55676469019193, 53.351523698782955],
          [110.69657855920889, 52.98270399734293],
          [111.24589496545889, 52.597364158479124],
          [112.14677387170889, 52.208604929524675],
          [113.02568012170889, 52.114252809927116],
          [114.49784809045889, 52.55730646891729],
          [115.64042621545889, 53.00915343932035],
          [116.82694965295889, 53.70417485031876],
          [117.81571918420889, 53.911769641414274],
          [119.19999652795889, 53.74317719703898],
          [121.11161762170889, 54.04099480755345],
          [123.08915668420889, 54.70652288721084],
          [124.31962543420889, 55.23621690971275],
          [125.11064105920889, 55.709463096537355],
          [127.17607074670889, 55.709463096537355],
          [128.7141566842089, 55.56063051320021],
          [130.4060512154589, 55.74658294765623],
          [131.8123012154589, 55.833058756942165],
          [132.6252894967089, 55.65991504753563],
          [134.1633754342089, 55.72184030157675],
          [135.2839809029589, 55.78366751676949],
          [136.3386684029589, 55.968561764206285],
          [137.1296840279589, 56.408724660610766],
          [137.6570277779589, 57.01171961721027],
          [138.5359340279589, 57.475372616743705],
          [138.9314418404589, 57.94487904297794],
          [139.3269496529589, 58.51176459873088],
          [139.8982387154589, 58.797514581578795],
          [140.3816371529589, 59.48497506357692],
          [140.6892543404589, 59.98331694948727],
          [141.1506801217089, 60.47426774238208],
          [141.5681605904589, 61.11749977211718],
          [141.4802699654589, 61.560117915156816],
          [141.3484340279589, 62.005370550663855],
          [141.3484340279589, 62.28257074035894],
          [141.0188441842089, 62.567366317753894],
          [140.3596644967089, 62.6381423969216],
          [139.5466762154589, 62.8795255328633],
          [139.4368129342089, 63.12887237956323],
          [138.8874965279589, 63.45476113795808],
          [138.8655238717089, 63.738118632327115],
          [139.5686488717089, 63.97049392322888],
          [139.5686488717089, 64.31547209539868],
          [139.3269496529589, 64.65618477063873],
          [138.4919887154589, 65.08539745048931],
          [136.4705043404589, 65.27907236661756],
          [134.7566371529589, 65.08539745048931],
          [134.2952113717089, 64.43899713874451],
          [133.0207973092089, 64.46742413006751],
          [131.6804652779589, 64.77817952788878],
          [130.4719691842089, 65.14087765874051],
          [129.4612269967089, 65.45308546284993],
          [128.9119105904589, 65.95930197910256],
          [127.83525043420889, 66.31485695550089],
          [128.3406215279589, 67.0882544782887],
          [128.4944301217089, 67.66300227012546],
          [128.6042934029589, 68.12602707743463],
          [128.6262660592089, 68.57991547735348],
          [128.5823207467089, 68.85902387415311],
          [128.6921840279589, 69.22837100628695],
          [129.2195277779589, 69.69092065983097],
          [128.9119105904589, 70.30713898396712],
          [129.2195277779589, 70.85500149830175],
          [129.1096644967089, 71.31792421967504],
          [129.16003768138654, 72.1335869517732],
          [129.37976424388654, 72.9121353934259],
          [127.97351424388654, 73.38348172964103],
          [126.78699080638654, 73.35832963839066],
          [125.33679549388654, 73.35832963839066],
          [124.54577986888654, 73.09198968252662],
          [124.36999861888654, 72.82151351573229],
          [124.36999861888654, 72.50725857773874],
          [124.58972518138654, 72.26791958015035],
          [124.58972518138654, 72.05251536272286],
          [124.58972518138654, 71.6832711233468],
          [125.07312361888654, 71.32077543514083],
          [124.28210799388654, 71.09427247199241],
          [124.19421736888654, 70.51638382219322],
          [124.32605330638654, 70.26567105523083],
          [123.71285184369367, 70.09035323860746],
          [122.83394559369367, 70.03790943991183],
          [121.81221707806867, 70.12773213782371],
          [121.15303739056867, 70.15385729104167],
          [120.32906278119367, 70.05665456251285],
          [120.29610379681867, 69.70521717842301],
          [120.43892606244367, 69.37495907179164],
          [121.19698270306867, 69.27410552963629],
          [120.77950223431867, 69.14542007033994],
          [119.69185574994367, 68.9094885387972],
          [119.06563504681867, 68.6069838033349],
          [118.88985379681867, 68.31658911256513],
          [118.47237332806867, 67.96481145639174],
          [117.93404324994367, 67.67865687564577],
          [116.81343778119367, 67.65360785323408],
          [115.45113309369367, 67.6661356965304],
          [114.37447293744367, 67.54055688896885],
          [113.55049832806867, 67.3043499041957],
          [112.97920926556867, 66.87237539616156],
          [112.25411160931867, 66.7685908094161],
          [111.50704129681867, 66.63388455901243],
          [111.01265653119367, 66.28726076776017],
          [110.46334012494367, 66.18987319701314],
          [109.70528348431867, 66.41945722310705],
          [108.79341824994367, 66.69046382401648],
          [108.04634793744367, 66.46336809128094],
          [107.11251004681867, 66.22090094406671],
          [106.42037137494367, 66.34463143354743],
          [105.91500028119367, 66.6077273493991],
          [105.36568387494367, 66.69481071329764]]]);
/***** End of imports. If edited, may not auto-convert in the playground. *****/
var lakes = ee.FeatureCollection("users/JohnPerrotti/HydroLAKES_polys_v10_shp");

// Import rivers for selecting relevant lakes
var rivers_1 = ee.FeatureCollection("WWF/HydroSHEDS/v1/FreeFlowingRivers")
  // Filter by large drainage area
          .filterMetadata("UPLAND_SKM", "greater_than", 2000)
  // Select only rivers from the Mackenzie River watershed
          .filterMetadata("BAS_NAME", "equals", "Lena")

// Generate lake areas to filter out the river lines that pass through lakes
var lakes_filtered = lakes  
                        .filterBounds(rivers_1)
                        .filterMetadata('Lake_area', 'greater_than', 200)
                        .filterMetadata('Country', 'equals', 'Canada')


//Map.addLayer(lakes_filtered, {}, 'lakes_filtered')


// Creating filters to select for rivers outside lakes
var filterInside = ee.Filter.bounds(lakes_filtered)
var filterNot = filterInside.not()

// Import rivers dataset and filter by size, basin, and remove lakes 
var rivers = ee.FeatureCollection("WWF/HydroSHEDS/v1/FreeFlowingRivers")
  // Filter by large drainage area
          .filterMetadata("UPLAND_SKM", "greater_than", 1000)
  // Select only rivers from the Mackenzie River watershed
          .filterMetadata("BAS_NAME", "equals", "Lena")
  // Filter for rivers outside lakes
          .filter(filterNot)

Map.addLayer(rivers, {}, 'Lena HydroSheds'); 

/// TRYING NEW MERIT HYDRO DATASET VERSUS HYDROSHEDS /// 
///// JFF 06/29/2022 /////
var MERIT_Rivers = ee.Image("MERIT/Hydro/v1_0_1")
var MERIT_7Only = MERIT_Rivers
                       .filterBounds(Lena_Watershed)
                       .filter(ee.Filter.eq('strmOrder', 7));