/**** Start of imports. If edited, may not auto-convert in the playground. ****/
var Thiessens = ee.FeatureCollection("users/jordanffieldsgr/ArcticCarbon/Thiessen_Polygons_300m"),
    Streamlines = ee.FeatureCollection("users/jordanffieldsgr/ArcticCarbon/MERIT_Vectors_filtered_Ord7"),
    WesternMack_1 = ee.FeatureCollection("users/jordanffieldsgr/ArcticCarbon/WesternMack_1"),
    GT_sites = /* color: #d63000 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Point([-134.1064730145831, 68.47124592323452]),
            {
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Point([-113.22297011852892, 61.08592767051099]),
            {
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Point([-113.43378635325908, 58.77639201025779]),
            {
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Point([-117.0778971065471, 56.56853307707214]),
            {
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Point([-125.00259427177433, 65.01346678495446]),
            {
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Point([-112.66638889422926, 56.411296506268314]),
            {
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Point([-126.02779009324698, 59.393899133675504]),
            {
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Point([-118.38546606539721, 55.0137731705575]),
            {
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Point([-137.18355380274366, 65.8603263263506]),
            {
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Point([-125.78813622283225, 61.6198680876714]),
            {
              "system:index": "9"
            })]),
    GT1985composite = 
    /* color: #98ff00 */
    /* shown: false */
    ee.Geometry.Polygon(
        [[[-134.0545912894386, 68.45165583239314],
          [-134.04944144813, 68.45159278345906],
          [-134.0490981253761, 68.45417764568998],
          [-134.04789649573743, 68.45424068742088],
          [-134.0484114798683, 68.4553123699676],
          [-134.0480681571144, 68.45619489394409],
          [-134.04772483436048, 68.45695131566292],
          [-134.04703818885267, 68.457833775698],
          [-134.04600822059095, 68.45922042905137],
          [-134.04480659095228, 68.46003977516409],
          [-134.04429160682142, 68.46092211470484],
          [-134.04429160682142, 68.46180441982123],
          [-134.04308997718275, 68.46262367232067],
          [-134.04171668616712, 68.46331686279169],
          [-134.04051505652845, 68.46419907447613],
          [-134.03931342688978, 68.46501824022008],
          [-134.03828345862806, 68.46577436687332],
          [-134.03759681312025, 68.46671948963035],
          [-134.03639518348157, 68.46766457287814],
          [-134.03628173612506, 68.46780114310336],
          [-134.0362206157588, 68.46784778190165],
          [-134.03068476875555, 68.46782940157989],
          [-134.03071038235328, 68.46779854774049],
          [-134.03080386228862, 68.4677329037731],
          [-134.0309202901312, 68.46759642641364],
          [-134.03128194176597, 68.46715021288311],
          [-134.03183366741303, 68.46625778631191],
          [-134.03190726902156, 68.46503999380539],
          [-134.03153966947468, 68.46354957323881],
          [-134.0301181055866, 68.46245916739637],
          [-134.02779023719407, 68.4624208930577],
          [-134.0277688337995, 68.465179787767],
          [-134.0268677754467, 68.46515223581096],
          [-134.026782047879, 68.46623125881521],
          [-134.02592383948743, 68.46681399973302],
          [-134.0247219872064, 68.46783786170212],
          [-134.02386365116766, 68.46850731754812],
          [-134.0224904135328, 68.46903106034665],
          [-134.02171802541523, 68.46954495009186],
          [-134.02064525880323, 68.46995939920156],
          [-134.01985145287406, 68.47007214346031],
          [-134.0199695599543, 68.47053801048571],
          [-134.01711044462303, 68.4705504460717],
          [-134.0168825640535, 68.4725095293819],
          [-134.0207172246828, 68.47194570231643],
          [-134.0246942604191, 68.47081328955953],
          [-134.027969988983, 68.46955404134401],
          [-134.02986519031978, 68.46848335574957],
          [-134.03046940200716, 68.46794797654603],
          [-134.0306848110439, 68.46782989740424],
          [-134.03622130014537, 68.46784961047727],
          [-134.03583549776118, 68.46805829478639],
          [-134.03467856971204, 68.46911362379221],
          [-134.03416358558118, 68.46999560930757],
          [-134.03313361731946, 68.47062557789233],
          [-134.0322753104347, 68.47138151701868],
          [-134.03107368079603, 68.47220042254276],
          [-134.02952872840345, 68.4729563090001],
          [-134.02781211463392, 68.47377515746774],
          [-134.02626716224134, 68.47446800607537],
          [-134.0245505484718, 68.47503486640973],
          [-134.02300559607923, 68.47604258300703],
          [-134.0209456595558, 68.47585363956804],
          [-134.01819907752454, 68.47679834096496],
          [-134.01682578650892, 68.477617050229],
          [-134.01699744788587, 68.4782468064005],
          [-134.0180274161476, 68.4789395179165],
          [-134.01699744788587, 68.47969517898541],
          [-134.01459418860853, 68.4793173516102],
          [-134.01270591346204, 68.47938032327819],
          [-134.01133262244642, 68.47994706039198],
          [-134.01150428382337, 68.48183608143299],
          [-134.01304923621595, 68.48202497484978],
          [-134.01150428382337, 68.48303237973084],
          [-134.01133262244642, 68.48397678100544],
          [-134.01407920447767, 68.48403973968655],
          [-134.01425086585462, 68.48775399127999],
          [-134.01425086585462, 68.48857230358126],
          [-134.01407920447767, 68.48989413004685],
          [-134.01407920447767, 68.49209700222232],
          [-134.0161391410011, 68.49215993826951],
          [-134.0161391410011, 68.49002001424638],
          [-134.01682578650892, 68.48850935753389],
          [-134.01751243201673, 68.48687269871691],
          [-134.0187140616554, 68.48542478627404],
          [-134.02077399817884, 68.48397678100544],
          [-134.02214728919446, 68.48271757053156],
          [-134.02403556434095, 68.48145828986098],
          [-134.0264388236183, 68.48038784609636],
          [-134.02884208289564, 68.47969517898541],
          [-134.03107368079603, 68.47938032327819],
          [-134.03364860145032, 68.4789395179165],
          [-134.03673850623548, 68.4788765450199],
          [-134.04051505652845, 68.4788135719478],
          [-134.04343329993665, 68.4788765450199],
          [-134.0465232047218, 68.4788765450199],
          [-134.0490981253761, 68.47912843555318],
          [-134.0520163687843, 68.47950626608763],
          [-134.05476295081556, 68.47969517898541],
          [-134.0575095328468, 68.47982112003973],
          [-134.06162940589368, 68.48026190820121],
          [-134.06368934241712, 68.48057675162275],
          [-134.06677924720228, 68.48095455793693],
          [-134.06986915198743, 68.48133235793297],
          [-134.07244407264173, 68.481710151611],
          [-134.07450400916517, 68.4822768302819],
          [-134.07639228431165, 68.48265460816523],
          [-134.07793723670423, 68.48303237973084],
          [-134.08034049598157, 68.48378790390926],
          [-134.0820571097511, 68.48504705471856],
          [-134.08343040076673, 68.4858654651047],
          [-134.0839453848976, 68.48718745000875],
          [-134.08343040076673, 68.48813167756514],
          [-134.08343040076673, 68.4888870311863],
          [-134.08343040076673, 68.4893905862309],
          [-134.10574637977064, 68.4893905862309],
          [-134.10574637977064, 68.48668384583624],
          [-134.11192618934095, 68.48668384583624],
          [-134.11218387734175, 68.4858026860412],
          [-134.11192618934095, 68.48517296593897],
          [-134.1120978507179, 68.48416565652228],
          [-134.11295615760267, 68.48259164562342],
          [-134.11484443274915, 68.48158422108699],
          [-134.11638938514173, 68.48070268776286],
          [-134.11862099404647, 68.47966387928045],
          [-134.1208525809425, 68.4784357298293],
          [-134.12394248572767, 68.47635748522795],
          [-134.12977897254407, 68.47390113152188],
          [-134.12991725682775, 68.47705482983666],
          [-134.1281671797048, 68.47876004362492],
          [-134.12658858599963, 68.47996148741633],
          [-134.12569651168903, 68.48166662818338],
          [-134.1243594347617, 68.48389080304413],
          [-134.12250714882467, 68.48510780305014],
          [-134.12168467211814, 68.48657661416888],
          [-134.12697916850266, 68.48666002587916],
          [-134.12726861410403, 68.48569344478406],
          [-134.12784772295777, 68.48413753611722],
          [-134.12934962006346, 68.48241027564619],
          [-134.13098038533965, 68.48071823824851],
          [-134.1321820811125, 68.4792228154795],
          [-134.13321220008314, 68.47786895480385],
          [-134.13400617145587, 68.47595599518625],
          [-134.13497182838267, 68.474231817139],
          [-134.13621634893434, 68.47267285454113],
          [-134.13836204139173, 68.471129540119],
          [-134.14042197791517, 68.46911362379221],
          [-134.14351188270032, 68.46753856406114],
          [-134.1472884329933, 68.46659347554555],
          [-134.14900504676282, 68.46596339458553],
          [-134.15003501502454, 68.46457715466116],
          [-134.15209495154798, 68.46369495772839],
          [-134.15363990394056, 68.46256065395136],
          [-134.15655814734876, 68.46186744029802],
          [-134.15930472938, 68.4614893148028],
          [-134.16239463416517, 68.4612372276267],
          [-134.16565620032728, 68.46041792489687],
          [-134.16565620032728, 68.45978767182945],
          [-134.16067802039564, 68.46073304484413],
          [-134.1611930045265, 68.45985069792657],
          [-134.15999137488782, 68.45966161910827],
          [-134.15981971351087, 68.45714041714021],
          [-134.15466987220228, 68.45701434966435],
          [-134.15466987220228, 68.45442981155949],
          [-134.15192329017103, 68.45430372897609],
          [-134.15157996741712, 68.45165583239314],
          [-134.14643012610853, 68.45165583239314],
          [-134.14591514197767, 68.45064702836434],
          [-134.14600118768885, 68.44932283885771],
          [-134.1428252371925, 68.45058397661907],
          [-134.13896294423034, 68.4520971591411],
          [-134.13578712073743, 68.45335808720141],
          [-134.13252555457532, 68.45518629230311],
          [-134.12909232703626, 68.4570773834901],
          [-134.12548743812025, 68.45840105325448],
          [-134.12222587195814, 68.45978767182945],
          [-134.11862098304212, 68.46111118298488],
          [-134.11518775550306, 68.46211952044892],
          [-134.1124411734718, 68.46293876153271],
          [-134.11020957557142, 68.46401003201282],
          [-134.1066046866554, 68.465144263085],
          [-134.10420142737806, 68.46640445310133],
          [-134.10196982947767, 68.4672235389458],
          [-134.09973823157728, 68.46829460642779],
          [-134.09733497229993, 68.46923962382994],
          [-134.09544669715345, 68.47018460172653],
          [-134.09287177649915, 68.47138151701868],
          [-134.09081183997571, 68.47257836893148],
          [-134.08909522620618, 68.47364918271148],
          [-134.08703528968275, 68.47497188263031],
          [-134.08514701453626, 68.47629450513487],
          [-134.08222877112806, 68.47742811995482],
          [-134.07999717322767, 68.47805788139205],
          [-134.07810889808118, 68.4785616779042],
          [-134.07484733191907, 68.4788765450199],
          [-134.07175742713392, 68.47875059870016],
          [-134.06901084510267, 68.47837275552854],
          [-134.06660758582532, 68.47786895480387],
          [-134.06334601966321, 68.47730216556106],
          [-134.06025611487806, 68.47686131965384],
          [-134.05733787146985, 68.47648344488765],
          [-134.05476295081556, 68.47616854442204],
          [-134.0520163687843, 68.4757276763977],
          [-134.04995643226087, 68.47522381669475],
          [-134.04738151160657, 68.47459397626737],
          [-134.04772483436048, 68.47383814458254],
          [-134.04463492957532, 68.47270434965658],
          [-134.04154517884388, 68.47314530589395],
          [-134.03879878770545, 68.47298788133429],
          [-134.0370823124449, 68.47284623319679],
          [-134.03708239636362, 68.47201955668716],
          [-134.0375972811846, 68.47072429806614],
          [-134.03888447175873, 68.46969864722539],
          [-134.03969957669443, 68.46849275813047],
          [-134.04113693748954, 68.46738571431484],
          [-134.04254216281043, 68.46645406691206],
          [-134.04410303468953, 68.46586214684037],
          [-134.04574179979363, 68.46525107567055],
          [-134.04793451952202, 68.46601665433957],
          [-134.04834441075664, 68.46690351673294],
          [-134.0482060970011, 68.4686070433872],
          [-134.04796535405356, 68.4701518003939],
          [-134.04681508611225, 68.4713021353057],
          [-134.04572503070477, 68.47194028473785],
          [-134.044493409895, 68.47257431300041],
          [-134.04610926738067, 68.47320627097788],
          [-134.0477755187016, 68.47377416253792],
          [-134.0515268758878, 68.47260933912486],
          [-134.05253135291517, 68.47094055560076],
          [-134.05287467566907, 68.46942862256965],
          [-134.05338965979993, 68.46797959184782],
          [-134.0535613211769, 68.46665648267576],
          [-134.05304633704603, 68.4656483475205],
          [-134.05064307776868, 68.46482920460562],
          [-134.04995643226087, 68.4637579729365],
          [-134.05029975501478, 68.46243461668594],
          [-134.05064307776868, 68.4613002496842],
          [-134.0520163687843, 68.45997674959389],
          [-134.0535613211769, 68.45877923038782],
          [-134.0539046439308, 68.4574555827559],
          [-134.0542479666847, 68.45619489394409],
          [-134.05476295081556, 68.45461893411701],
          [-134.0545912894386, 68.45354721871863]]]),
    site2start = 
    /* color: #d63000 */
    /* shown: false */
    ee.Geometry.MultiPolygon(
        [[[[-113.16393441185633, 61.10274095512537],
           [-113.16118782982508, 61.102906862150014],
           [-113.15801209435145, 61.10373638421801],
           [-113.15414971337, 61.10510504806116],
           [-113.15080231651942, 61.10668101183609],
           [-113.15080231651942, 61.10717866828929],
           [-113.15277642235438, 61.10676395512221],
           [-113.15620964989344, 61.10610040274129],
           [-113.15861290917078, 61.105022100423575],
           [-113.1622177980868, 61.103529005740874],
           [-113.16462105736414, 61.10319719734885]]],
         [[[-113.1677109621493, 61.105022100423575],
           [-113.1607586763827, 61.10477325620537],
           [-113.15947121605555, 61.10568567543214],
           [-113.15835541710535, 61.10622481987338],
           [-113.15552300438563, 61.10697131238566],
           [-113.1570679567782, 61.107386022833104],
           [-113.15990036949793, 61.10680542668371],
           [-113.16487854942957, 61.10643218067233],
           [-113.16582268700282, 61.10605893025515],
           [-113.16153115257899, 61.10610040274129],
           [-113.1622177980868, 61.10535388966846],
           [-113.16693848595301, 61.10560272931758]]],
         [[[-113.22187944387792, 61.059924993351316],
           [-113.21947618460058, 61.05899048691781],
           [-113.2183818433225, 61.0589385690855],
           [-113.21765228247045, 61.05915662340949],
           [-113.21765228247045, 61.05939544308999],
           [-113.21857496237158, 61.05944736017364],
           [-113.21971221899389, 61.060340320696135],
           [-113.22177215551733, 61.060880238104424]]],
         [[[-113.21340366339086, 61.059779627494315],
           [-113.21486278509497, 61.059094322327184],
           [-113.21580692266821, 61.05888665116811],
           [-113.21329637503027, 61.05880358232333],
           [-113.21252389883398, 61.05934352592129],
           [-113.21256681417822, 61.05981077737696]]],
         [[[-113.17424167316598, 61.08363418184746],
           [-113.17155946415109, 61.08365493280131],
           [-113.17153800647897, 61.08590633047519],
           [-113.17507596266162, 61.08599725995395],
           [-113.18061204206836, 61.08597651053583],
           [-113.18782181990039, 61.08597651053583],
           [-113.19131756341146, 61.08572751645731],
           [-113.19732571160482, 61.085208772501716],
           [-113.20630529343987, 61.08539873602653],
           [-113.2114980500927, 61.08672669560367],
           [-113.21537382964313, 61.08898296426877],
           [-113.21709044341266, 61.09151405238766],
           [-113.2211674011153, 61.091534798175005],
           [-113.22269721983804, 61.0918271327613],
           [-113.22655960081948, 61.093175567302644],
           [-113.22844787596597, 61.095291456426395],
           [-113.22883411406411, 61.09713755780066],
           [-113.22830509032602, 61.0996815639455],
           [-113.22650264586801, 61.101382234191604],
           [-113.22532251595945, 61.10266802488749],
           [-113.22452854003305, 61.103995280994816],
           [-113.22259734954233, 61.10418191893358],
           [-113.22238277282113, 61.10507361832637],
           [-113.22208236541147, 61.10596529257538],
           [-113.21869205321664, 61.105965292575426],
           [-113.21869205321664, 61.107541213477745],
           [-113.21953006718996, 61.10829860506929],
           [-113.2194656941736, 61.10968780534151],
           [-113.2186717603052, 61.11057934947809],
           [-113.22974391911868, 61.11060008276352],
           [-113.22979937396546, 61.10900291264613],
           [-113.23101520220845, 61.10746198374674],
           [-113.23234557787984, 61.10555427523438],
           [-113.23393344561666, 61.10360497592024],
           [-113.23504924456685, 61.102308034132115],
           [-113.2366800276479, 61.09940631486357],
           [-113.23728084246724, 61.099198907992125],
           [-113.23714328975744, 61.09682394168316],
           [-113.23665674816236, 61.093525255713196],
           [-113.2350259650813, 61.089542065711164],
           [-113.23260838498145, 61.086768746408566],
           [-113.22896058072119, 61.08490128981747],
           [-113.22127873410254, 61.08261869322165],
           [-113.209779731876, 61.081601847193674],
           [-113.19784926617776, 61.08129056126671],
           [-113.19119738782082, 61.08141507600486],
           [-113.18115519726906, 61.08185087373115],
           [-113.17437457287942, 61.08214140221535]]],
         [[[-113.21994663043662, 61.10475341645082],
           [-113.2200324611251, 61.10336399937151],
           [-113.21981788440391, 61.101371110132604],
           [-113.21930290027305, 61.1002304263716],
           [-113.21981788440391, 61.10015783601272],
           [-113.21951873425921, 61.09944778930046],
           [-113.21923978452166, 61.09668917028184],
           [-113.21984116705605, 61.095363407225655],
           [-113.2201201167936, 61.09292597908848],
           [-113.22080676230141, 61.09156716103159],
           [-113.21715895804115, 61.091556788150235],
           [-113.21713750036903, 61.09259405945349],
           [-113.21748082312294, 61.09520783231699],
           [-113.2174379077787, 61.0977799058985],
           [-113.2174379077787, 61.100206590027256],
           [-113.21846787604042, 61.10259161095151],
           [-113.21829621466347, 61.104831292925816],
           [-113.2186609950895, 61.10596144259395],
           [-113.22044198187538, 61.10596144259395]]]]),
    site2end = 
    /* color: #14ffef */
    /* shown: false */
    ee.Geometry.MultiPolygon(
        [[[[-113.28380942666155, 61.107624714022705],
           [-113.2849895986281, 61.107002651007704],
           [-113.28496814095598, 61.105945115795485],
           [-113.28471064889055, 61.10554075474958],
           [-113.28374505364519, 61.10549928152942],
           [-113.2838737996779, 61.106079901661715],
           [-113.28389525735003, 61.10687823693615],
           [-113.28292966210466, 61.107469199416286]]],
         [[[-113.1679981127322, 61.10253981404908],
           [-113.1652944460452, 61.10264350670097],
           [-113.16520861535672, 61.10287162933839],
           [-113.16422156243924, 61.102881998510085],
           [-113.16321305184964, 61.10268498366653],
           [-113.16183976083401, 61.102964951761244],
           [-113.16072396188382, 61.103234548324785],
           [-113.15911463647488, 61.10361820101047],
           [-113.15780571847561, 61.104105536900086],
           [-113.1553166285098, 61.10490392202096],
           [-113.15235546975735, 61.105971860213316],
           [-113.15085343270901, 61.10675983031863],
           [-113.15141133218411, 61.10695681977687],
           [-113.1535356417239, 61.10638658376906],
           [-113.15538100152615, 61.105971860213316],
           [-113.15821341424588, 61.10494539602193],
           [-113.16046646981839, 61.10396037380342],
           [-113.16299847512845, 61.103161964860696],
           [-113.16559485345486, 61.102850890984804],
           [-113.16806248574856, 61.10277830664016]]],
         [[[-113.16862038522366, 61.10530829121031],
           [-113.16477946191434, 61.105329027952415],
           [-113.16424302011136, 61.10508018614947],
           [-113.15973690896634, 61.105142396783776],
           [-113.15973690896634, 61.105360133040094],
           [-113.16411427407864, 61.10527718607163],
           [-113.16458634286526, 61.1054741847665],
           [-113.16851309686307, 61.105660813976925]]],
         [[[-113.16016606240872, 61.106158486486486],
           [-113.16010168939236, 61.10552602632434],
           [-113.15975836663846, 61.10554676292366],
           [-113.15890005975369, 61.10644879183325],
           [-113.16106728463772, 61.106396951788255]]],
         [[[-113.221865416878, 61.06064958726738],
           [-113.22044921051814, 61.05946590153592],
           [-113.21864676606013, 61.059486668333385],
           [-113.21813178192927, 61.05969433555951],
           [-113.22117877137019, 61.061002607783294]]],
         [[[-113.21504187714412, 61.0589882614369],
           [-113.21396899353816, 61.05902979564443],
           [-113.21238112580134, 61.05932053357243],
           [-113.21229529511287, 61.059715102207264],
           [-113.21422648560359, 61.059798168662155]]],
         [[[-113.2120810694937, 61.066944023421115],
           [-113.21182357742828, 61.06555294541526],
           [-113.21143733933013, 61.06555294541526],
           [-113.21152317001861, 61.06717240352364]]],
         [[[-113.21748840286773, 61.065656759316354],
           [-113.21748840286773, 61.06511692331514],
           [-113.21701633408111, 61.06511692331514],
           [-113.21701633408111, 61.065843623480816]]],
         [[[-113.17528747516178, 61.086228626015185],
           [-113.18266891437077, 61.08608338086456],
           [-113.1916811366608, 61.08589663611996],
           [-113.1942560573151, 61.08566839104674],
           [-113.20589676534132, 61.0854497726873],
           [-113.209802061667, 61.08630050183389],
           [-113.21379318868117, 61.08769066853658],
           [-113.21559563313917, 61.08945422498073],
           [-113.21671851073158, 61.09101895855254],
           [-113.21693308745277, 61.09352913934662],
           [-113.21725581384288, 61.09597110040534],
           [-113.2173845598756, 61.09974607779289],
           [-113.21789416158447, 61.10081999058042],
           [-113.21802290761718, 61.10347455976687],
           [-113.21836623037109, 61.10631553149265],
           [-113.2188096119975, 61.10701651275159],
           [-113.22041893740644, 61.106767684228004],
           [-113.21988249560346, 61.105654054423084],
           [-113.21949625750531, 61.103518120504866],
           [-113.2202687337016, 61.102854500011006],
           [-113.21958208819379, 61.10206643258756],
           [-113.21931146097246, 61.09949810013512],
           [-113.21924839211589, 61.09639030074113],
           [-113.21989212227946, 61.09535315389914],
           [-113.22019252968913, 61.09261492285321],
           [-113.22075042916423, 61.09178510907832],
           [-113.22220955086833, 61.09151541491543],
           [-113.2245269794572, 61.092407471449846],
           [-113.22726649993557, 61.09412855551767],
           [-113.2287685369839, 61.096617747167606],
           [-113.22851104491848, 61.09906526130318],
           [-113.22789658222494, 61.09997498652322],
           [-113.22599046220996, 61.10166352551255],
           [-113.22380177965381, 61.103841060141],
           [-113.22272889604785, 61.10386179784528],
           [-113.22298638811328, 61.104857191658354],
           [-113.22195641985157, 61.106619791336364],
           [-113.21882359972217, 61.107075977600864],
           [-113.21955316057422, 61.108382292768],
           [-113.21955316057422, 61.10956415046303],
           [-113.21865193834522, 61.110538631471094],
           [-113.22993867387989, 61.11062156463807],
           [-113.22955243578174, 61.109087265832486],
           [-113.23058240404346, 61.10861037400895],
           [-113.23195569505909, 61.10678567801223],
           [-113.23259942522266, 61.105147508951966],
           [-113.234101462271, 61.10411631541475],
           [-113.23716141066011, 61.09948370088652],
           [-113.23722698653955, 61.0936529072299],
           [-113.2363497818276, 61.091588299703446],
           [-113.23428984530416, 61.08860077132131],
           [-113.23230765633772, 61.086646518931325],
           [-113.22874568276595, 61.08471680443636],
           [-113.22515172932606, 61.08359428818164],
           [-113.22133226368885, 61.082577473495775],
           [-113.21721239064198, 61.08232845267482],
           [-113.21382207844715, 61.081788900841694],
           [-113.20476694081287, 61.081187082177394],
           [-113.19193525288563, 61.081415359569434],
           [-113.18592710469227, 61.08174739647357],
           [-113.17433996174793, 61.08226619716348],
           [-113.17442579243641, 61.083635790128014],
           [-113.17155046437244, 61.083698042945535],
           [-113.17167921040516, 61.086188055243895]]]]),
    site4start = 
    /* color: #ff0000 */
    /* shown: false */
    ee.Geometry.Polygon(
        [[[-117.09711059658827, 56.545395375019],
          [-117.08992227642835, 56.54535988769531],
          [-117.08987936108412, 56.54689764120991],
          [-117.09096558020464, 56.54719900572425],
          [-117.0920384638106, 56.54847646635733],
          [-117.09199554846636, 56.54944636137986],
          [-117.09066517279497, 56.55086567515523],
          [-117.08907730505815, 56.55230858960254],
          [-117.08619897329832, 56.55473551827542],
          [-117.08431069815184, 56.5563201937218],
          [-117.08293740713621, 56.55634384509156],
          [-117.0807916399243, 56.556391147786684],
          [-117.07959001028563, 56.557952103555415],
          [-117.07803729494458, 56.56040197526776],
          [-117.07674983461743, 56.56227018639471],
          [-117.07566140276278, 56.56470992655544],
          [-117.07433102709139, 56.56676708421812],
          [-117.07408587694668, 56.57053631704637],
          [-117.07545916796231, 56.572049406225766],
          [-117.07717578173184, 56.57419565092032],
          [-117.07940737963223, 56.57575587218791],
          [-117.08292643785977, 56.57759968705771],
          [-117.08730380297207, 56.57892339613471],
          [-117.09029374200288, 56.57964585702879],
          [-117.093555308165, 56.580071316975044],
          [-117.09484276849214, 56.57969313059258],
          [-117.09836182671968, 56.57978767754282],
          [-117.10093674737398, 56.58030768154306],
          [-117.10248169976656, 56.58082767839132],
          [-117.10436997491304, 56.58078040624612],
          [-117.10617241937105, 56.58002404388408],
          [-117.11157975274507, 56.58035037520668],
          [-117.11162266808931, 56.5777502866208],
          [-117.11162259853424, 56.57769246094878],
          [-117.11697633153364, 56.577714579359345],
          [-117.1169334161894, 56.57736000763647],
          [-117.11442286855146, 56.57736000763647],
          [-117.11399371510907, 56.57762002722501],
          [-117.1104317415373, 56.57760820819158],
          [-117.10899630953294, 56.57789068735842],
          [-117.10496226717454, 56.57798523881593],
          [-117.10243026186448, 56.577937963116746],
          [-117.09667960573655, 56.577937963116746],
          [-117.09251681734544, 56.57777249770405],
          [-117.08835893606539, 56.576791456284106],
          [-117.08428197836275, 56.57508944013988],
          [-117.08132081961031, 56.57291453024835],
          [-117.07942781489636, 56.5712502955216],
          [-117.07895574610974, 56.56942981424141],
          [-117.07848367732312, 56.56794026438154],
          [-117.07899866145398, 56.567278223392556],
          [-117.07917032283093, 56.565883170519434],
          [-117.08015663873577, 56.564842758614205],
          [-117.08110077630901, 56.56455900494666],
          [-117.08174450647259, 56.563211145960274],
          [-117.08376152765179, 56.56053893266828],
          [-117.08685143243694, 56.557227964160006],
          [-117.08796723138714, 56.55623461711187],
          [-117.08916886102581, 56.55628191994356],
          [-117.08865387689495, 56.555430459926846],
          [-117.0928595806303, 56.550593377662956],
          [-117.09500534784222, 56.54841705912304],
          [-117.09586365472698, 56.54661913638431],
          [-117.09629280816937, 56.545814774881194]]]),
    site4end = 
    /* color: #0b4a8b */
    /* shown: false */
    ee.Geometry.Polygon(
        [[[-117.0975808107856, 56.545401489454754],
          [-117.08908357262642, 56.5453778312465],
          [-117.08839692711861, 56.54686826949331],
          [-117.08745278954537, 56.547909175689135],
          [-117.08758153557808, 56.5485715556388],
          [-117.0900706255439, 56.548500586912866],
          [-117.09114350914986, 56.54951779260384],
          [-117.090628525019, 56.55085289149233],
          [-117.08788194298775, 56.552697920460105],
          [-117.08668031334908, 56.55402250117662],
          [-117.0862511599067, 56.55487399287152],
          [-117.08376206994087, 56.55629310312317],
          [-117.08281793236763, 56.55629310312317],
          [-117.08264627099068, 56.55695533636237],
          [-117.08127297997505, 56.55690803437246],
          [-117.08187379479439, 56.555157819179136],
          [-117.0825604403022, 56.55402250117662],
          [-117.08118714928658, 56.5544009442951],
          [-117.08032884240181, 56.55662422119143],
          [-117.07854502967804, 56.558732232947634],
          [-117.07631343177765, 56.56327273546168],
          [-117.07476847938507, 56.56613775360644],
          [-117.07433932594269, 56.56727270813971],
          [-117.07399600318878, 56.56949522879517],
          [-117.07476847938507, 56.57181218575532],
          [-117.07814928763489, 56.57506203432163],
          [-117.08072420828918, 56.576858605974145],
          [-117.08553072684387, 56.57860781740994],
          [-117.08999392264465, 56.57983694460335],
          [-117.09205385916809, 56.58021512954728],
          [-117.09625956290344, 56.57997876440063],
          [-117.0996927904425, 56.58035694792598],
          [-117.1022677110968, 56.58078239987031],
          [-117.10544344657043, 56.58068785540755],
          [-117.10750338309387, 56.57988421792822],
          [-117.10914185511004, 56.580029498665965],
          [-117.11163094507586, 56.58040768168385],
          [-117.11158802973162, 56.577713045137244],
          [-117.11699536310564, 56.577760321117665],
          [-117.11699536310564, 56.57714572876164],
          [-117.11497834192645, 56.57735847339997],
          [-117.11143515707133, 56.57736423140062],
          [-117.11143515707133, 56.5776301604748],
          [-117.1080448448765, 56.5778960876787],
          [-117.10687462811357, 56.57817726475121],
          [-117.09751908306963, 56.57803543819655],
          [-117.09146801953203, 56.577539041065855],
          [-117.08664071559224, 56.57621985469281],
          [-117.08299291133198, 56.573997729189884],
          [-117.08050382136616, 56.57165726433855],
          [-117.07970930308277, 56.57020230037688],
          [-117.07958055705005, 56.56845270010092],
          [-117.08009554118091, 56.56816897351115],
          [-117.08009554118091, 56.56717591368694],
          [-117.07923723429614, 56.566963111761254],
          [-117.07966638773853, 56.565464479255034],
          [-117.0812113401311, 56.56503885495064],
          [-117.08155466288501, 56.563951126638564],
          [-117.08387209147388, 56.56106613051397],
          [-117.08666158884937, 56.557802509069816],
          [-117.08869774809436, 56.55607598678398],
          [-117.09071476927356, 56.553450575914205],
          [-117.09251017726038, 56.55144775984712],
          [-117.09439845240686, 56.549697292119745],
          [-117.0961150661764, 56.54676389444421],
          [-117.09697337306116, 56.54652732021028]]]),
    site6start = 
    /* color: #ffc82d */
    /* shown: false */
    ee.Geometry.Polygon(
        [[[-112.67418859089184, 56.39445979556845],
          [-112.6708841093855, 56.39445979556845],
          [-112.67109868610669, 56.39645494868038],
          [-112.67114160145093, 56.39747623660095],
          [-112.66882417286206, 56.39963747651385],
          [-112.66539147111126, 56.402296519802405],
          [-112.66410401078411, 56.40391131936247],
          [-112.6634173652763, 56.40462370915429],
          [-112.6634173652763, 56.40642837028473],
          [-112.6630740425224, 56.408707819927564],
          [-112.66315987321087, 56.41017989192745],
          [-112.66496231766888, 56.412126738400794],
          [-112.66672705868207, 56.41339722081166],
          [-112.66947364071332, 56.4145367539899],
          [-112.67428015926801, 56.4152489448949],
          [-112.6783142016264, 56.415391381476105],
          [-112.68422384872808, 56.41578366042844],
          [-112.69006033554449, 56.41663825990522],
          [-112.69443770065679, 56.417117846920824],
          [-112.6965834678687, 56.4175451340736],
          [-112.69963045730962, 56.4187320176503],
          [-112.69995232239141, 56.418708280341676],
          [-112.69995232239141, 56.416999155193324],
          [-112.69875069275274, 56.41648877654533],
          [-112.69495268478765, 56.415871565312564],
          [-112.6919511008106, 56.4152545736428],
          [-112.6888182806812, 56.41487474020872],
          [-112.68620044468267, 56.41473230169328],
          [-112.68379718540533, 56.41432872300358],
          [-112.68173724888189, 56.413972620604575],
          [-112.6789433707668, 56.413877659401926],
          [-112.67572471994893, 56.413806438344416],
          [-112.67297813791768, 56.41354529332622],
          [-112.6705319632961, 56.413165442827356],
          [-112.66776991561575, 56.41200797291295],
          [-112.66635370925589, 56.41074965277123],
          [-112.66609621719046, 56.409420061748946],
          [-112.66562414840384, 56.40725937725236],
          [-112.66566706374807, 56.4055595042556],
          [-112.66626787856741, 56.404229731887696],
          [-112.66860740327134, 56.40233632350865],
          [-112.67028110169663, 56.40095894177568],
          [-112.67193019759135, 56.39957137593242],
          [-112.67296016585307, 56.398312644541996],
          [-112.67353007295262, 56.39753934493489],
          [-112.67400214173924, 56.39639930271668]]]),
    site6end = 
    /* color: #00ffff */
    /* shown: false */
    ee.Geometry.Polygon(
        [[[-112.67413740267743, 56.394470464611885],
          [-112.67061834444989, 56.394470464611885],
          [-112.67109041323651, 56.39675063042332],
          [-112.67066125979413, 56.39819941483128],
          [-112.66821441380773, 56.40074937507023],
          [-112.66598281590734, 56.401913034828254],
          [-112.66456660954748, 56.40336162277908],
          [-112.66363301930264, 56.40454467219258],
          [-112.6635901039584, 56.40561323409861],
          [-112.66307511982754, 56.40703793663933],
          [-112.66333261189297, 56.40951406885597],
          [-112.66346135792568, 56.410724945291555],
          [-112.66522088703945, 56.412600540563616],
          [-112.66813608908822, 56.41424163384295],
          [-112.6702389409559, 56.41493009060617],
          [-112.67444464469125, 56.41526244458485],
          [-112.67538878226449, 56.415618534911616],
          [-112.68049570822885, 56.41559479566019],
          [-112.68482062304574, 56.41604583890431],
          [-112.68958422625619, 56.41680547859668],
          [-112.69585419507301, 56.41753069320231],
          [-112.69838620038307, 56.41836151590959],
          [-112.69930888028419, 56.41869977424273],
          [-112.69993115277565, 56.41870570857257],
          [-112.69995261044777, 56.41700845249887],
          [-112.6976351818589, 56.416463928740725],
          [-112.69475985379493, 56.415965412427866],
          [-112.69330073209083, 56.415526237882865],
          [-112.69083663265212, 56.415455019911356],
          [-112.68783255855544, 56.41476657264703],
          [-112.6859871987532, 56.41479031241524],
          [-112.68336936275466, 56.414410474346134],
          [-112.68100901882156, 56.41429177417184],
          [-112.6775757912825, 56.414054372712265],
          [-112.67470046321853, 56.4138169697714],
          [-112.67173930446609, 56.4135558248255],
          [-112.66890689174636, 56.4127961202458],
          [-112.66731902400954, 56.41194143446193],
          [-112.66671820919021, 56.41108672947953],
          [-112.66611739437087, 56.41001832125325],
          [-112.66573533617914, 56.40929616460878],
          [-112.6656924208349, 56.40694551630701],
          [-112.66577825152338, 56.40501081701612],
          [-112.66612157427728, 56.40394223819659],
          [-112.66779879137538, 56.40274009897825],
          [-112.67015913530848, 56.4010540048017],
          [-112.67191866442225, 56.39972407501893],
          [-112.67281988665125, 56.3992015898919],
          [-112.67346361681483, 56.39877409672682],
          [-112.67346361681483, 56.39746783786684],
          [-112.6743219236996, 56.397277832844296],
          [-112.67402151628993, 56.39642279850787]]]);
/***** End of imports. If edited, may not auto-convert in the playground. *****/

//////// Load and prep images as in main file ///////////
// Functions to renmae bands in LS5 and LS7 image Collections
// Function to get and rename bands of interest from ETM+ (LANDSAT 7).
function renameEtm(img) {
  return img.select(
      ['B1', 'B2', 'B3', 'B4', 'B5', 'B7', 'pixel_qa'],
      ['Blue', 'Green', 'Red', 'NIR', 'SWIR1', 'SWIR2', 'pixel_qa']);
}

// Define function to prepare ETM+ images.
// works for TM images as well (landsat 5)
function prepEtm(img) {
  var orig = img;
  img = renameEtm(img);
  return ee.Image(img.copyProperties(orig, orig.propertyNames()));
}


//// IMPORT IMAGES ////
// using collection 1 (deprecated) instead of collection 2 because we built this before collection 2 existed
// water detection tool is calibrated for collection 1 values
// NOT using LS8 because surface reflectance images are bad/weird
var ls5old = ee.ImageCollection('LANDSAT/LT05/C01/T1_SR')
                                .filter(ee.Filter.bounds(WesternMack_1)) // change this if re-defining project area
                                .filter(ee.Filter.dayOfYear(151,270))
                                .filterMetadata('CLOUD_COVER', 'less_than', 20);
var ls7old = ee.ImageCollection('LANDSAT/LE07/C01/T1_SR')
                                .filter(ee.Filter.bounds(WesternMack_1)) // change this if re-defining project area
                                .filter(ee.Filter.dayOfYear(151,270))
                                .filterMetadata('CLOUD_COVER', 'less_than', 20);
  
// Defining function to remove Speckle from water occurence sensing code
var removeSpeckle = function(image){
  var imageSel = image.select(['Green', 'NIR']);
  var replaceNegatives = imageSel.where(imageSel.lt(0), 1);
  var returnImage = image.addBands(replaceNegatives, null, true);
  return returnImage;
  };
  
// Filter collections and prepare them for merging.
var etmCol = ls7old.map(prepEtm);
var tmCol = ls5old.map(prepEtm);

// Merge the collections.
var allImages = etmCol
                      .merge(tmCol)
                      .map(removeSpeckle);
/////////////////////////////////

// Filter image collection for Groundtruth Site
// change the number in the .get() call in order to cycle through the sites
var site = ee.Feature(GT_sites.toList(10).get(5));
//Map.addLayer(site);

// Filter for those images containing the site AOI
//just copied the coords from printing the feature foe now bc can't seem to filter an image collection by a feature
var siteImage1 = allImages.filter(ee.Filter.bounds(site.geometry()))
                          .filter(ee.Filter.date('2010-07-15','2010-08-15')); //change dates for the 2yr period you want. 

var siteImage2 = allImages.filter(ee.Filter.bounds(site.geometry()))
                          .filter(ee.Filter.date('2015-07-01','2015-08-31')); //change dates for the 2yr period you want. 

//print(siteImage1); // check how many images you have and record that number
//print(siteImage2);

//Define a true color visParams dictionary for LANDSAT imagery 
var trueColor_LANDSAT = {
  bands: ['Red', 'Green', 'Blue'], 
  min: 270,
  max: 1100,
};

// Map.addLayer(ee.Image(siteImage1.toList(7).get(3)), trueColor_LANDSAT, 'start image');
// Map.addLayer(ee.Image(siteImage1.toList(4).get(2)), trueColor_LANDSAT, 'start image');
//Map.addLayer(ee.Image(siteImage1.toList(4).get(3)), trueColor_LANDSAT, 'start image');
// Map.addLayer(ee.Image(siteImage2.toList(2).get(1)), trueColor_LANDSAT, 'end image');
// Map.addLayer(ee.Image(siteImage2.toList(2).get(0)), trueColor_LANDSAT, 'end image 2');
Map.addLayer(Thiessens, {}, 'Thiessens'); 
// print("start image: ", siteImage1.toList(4).get(2))
// print("end image: ", siteImage2.toList(2).get(0))
// print("end image: ", siteImage2.toList(2).get(1))

// Calculate difference of polygons
var GTdiff = site6end.difference(site6start);
//Map.addLayer(GTdiff);
//print("diff area", GTdiff.area().divide(1000*1000));


//Calculate area of polygons
var start_area = site6start.area().divide(1000*1000); 
var end_area = site6end.area().divide(1000*1000);
//print("start area: ", start_area, "end area: ", end_area)


// checking duplicate point IDs
var ID = 8109555;
var to_check = Thiessens.filter(ee.Filter.eq("point_ID", ID));
print(to_check);
Map.addLayer(to_check);

/*
///////// how to do the actual area change calculation with two polygons
print("end year area", end_year_GWY.area().divide(1000*1000))
print("start year area", start_year_GWY.area().divide(1000*1000))

var diff = end_year_GWY.difference(start_year_GWY)
var intersect = end_year_GWY.intersection(start_year_GWY)
var alsodiff = ee.Number(end_year_GWY.area().divide(1000*1000)).subtract(ee.Number(intersect.area().divide(1000*1000)));


print("diff area", diff.area().divide(1000*1000))
print("intersecting area", intersect.area().divide(1000*1000))
print("geometry area minus intersecting area", alsodiff)
Map.addLayer(diff, {}, "difference")
Map.addLayer(intersect, {}, "intersection")

// method 1: take end year polygon area, subtract area of intersection between start and end year polygons
// method 2 (simpler): take the difference of end year and start year polygons (make sure you do end diff start not start diff end)
*/




// make composite image using median --  this doesn't quite match our 0.25 threshold
// but not sure how to match that here
//var composite = siteImages.median(); 

/*

// Create composite image using images from time period of interest
// Load three NAIP quarter quads in the same location, different times.
var naip2004_2012 = ee.ImageCollection('USDA/NAIP/DOQQ')
  .filterBounds(ee.Geometry.Point(-71.08841, 42.39823))
  .filterDate('2004-07-01', '2012-12-31')
  .select(['R', 'G', 'B']);

// Temporally composite the images with a maximum value function.
var composite = naip2004_2012.max();
Map.setCenter(-71.12532, 42.3712, 12);
Map.addLayer(composite, {}, 'max value composite');

*/